# Интеграция с CipherLab RK26 Сканером

## Обзор

Приложение было обновлено для интеграции с встроенным лазерным сканером CipherLab RK26. Реализованы следующие возможности:

1. **Программный запуск сканера** - кнопка "Сканировать" активирует лазерный сканер
2. **Автоматическое получение результатов** - отсканированные данные автоматически попадают в поле ввода
3. **Диагностика сканера** - кнопка для проверки доступности различных функций сканера

## Основные компоненты

### 1. CipherLabScanner.kt

Класс для программного управления сканером:

- `triggerScan()` - запускает сканирование
- `stopScan()` - останавливает сканирование
- `isScannerAvailable()` - проверяет доступность сканера

### 2. ScannerBroadcastReceiver.kt

Получает результаты сканирования от системы:

- Обрабатывает различные форматы данных от CipherLab
- Поддерживает множественные ключи для извлечения данных
- Логирует все события для отладки

### 3. ScannerUtils.kt

Утилиты для диагностики и отладки:

- `diagnoseScanner()` - проверяет доступность различных функций
- `triggerScannerWithLogging()` - детальный запуск с логированием
- `getSystemInfo()` - информация о системе

## Использование

### Запуск сканера

Нажмите кнопку "Сканировать" для активации лазерного сканера.

### Получение результатов

Отсканированные штрихкоды автоматически появятся в поле ввода.

### Диагностика

Нажмите "Диагностика сканера" для проверки доступности функций (результаты в логах).

## Технические детали

### Intent действия для запуска сканера:

- `com.cipherlab.scanner.ACTION_SCAN`
- `com.cipherlab.scanner.ACTION_SCAN_START`
- `com.cipherlab.scanner.START_SCAN`
- `com.cipherlab.barcode.ACTION_TRIGGER_SCAN`
- `com.cipherlab.scanner.TRIGGER_SCAN`
- `com.cipherlab.scanner.SCANNER_TRIGGER`
- `com.cipherlab.scanner.SOFTWARE_TRIGGER`

### Intent действия для получения результатов:

- `com.cipherlab.scanner.ACTION_SCAN_RESULT`
- `com.cipherlab.barcode.ACTION_RESULT`
- `com.cipherlab.scanner.ACTION_SCAN_DATA`
- `com.cipherlab.scanner.ACTION_SCAN`

### Ключи для извлечения данных:

- `com.cipherlab.scanner.EXTRA_BARCODE_DATA`
- `com.cipherlab.scanner.EXTRA_SCAN_DATA`
- `com.cipherlab.scanner.EXTRA_RESULT`
- `data`, `barcode`, `result`, `scan_result`

## Логирование

Все действия сканера логируются с тегами:

- `CipherLabScanner` - действия по запуску сканера
- `ScannerBroadcastReceiver` - получение результатов
- `ScannerUtils` - диагностические операции
- `MainActivity` - общие операции приложения

## Отладка

1. Используйте кнопку "Диагностика сканера" для проверки доступности функций
2. Проверьте логи Android Studio для детальной информации
3. При проблемах проверьте разрешения приложения

## Примечания

- Приложение пытается использовать несколько методов запуска сканера для максимальной совместимости
- Все операции безопасны и не влияют на другие функции устройства
- Если сканер не запускается программно, можно использовать физическую кнопку на устройстве

## Совместимость

Код протестирован и должен работать с:

- CipherLab RK26 с Android
- Различными версиями ПО CipherLab
- Различными конфигурациями сканера

При возникновении проблем проверьте логи и используйте функцию диагностики.
